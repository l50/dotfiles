# Set default terminal type to screen-256color, which provides full terminal functionality when in tmux.
set -g default-terminal "screen-256color"

# Enable mouse support
setw -g mouse on

# Prevent mouse selection from crossing pane boundaries
unbind -n MouseDrag1Pane
unbind -n MouseDragEnd1Pane
bind -n MouseDrag1Pane if -Ft= '#{mouse_any_flag}' 'if -Ft= "#{pane_in_mode}" "copy-mode -M" "send-keys -M"' 'copy-mode -M'

# Don't auto-copy on drag end
unbind -T copy-mode-vi MouseDragEnd1Pane
unbind -T copy-mode MouseDragEnd1Pane

# Customize word separators to include paths and special chars
set-option -gs word-separators " \t\"'`@"

# Enable double-click to select word
bind -n DoubleClick1Pane select-pane \; copy-mode -M \; send-keys -X select-word
bind -T copy-mode-vi DoubleClick1Pane select-pane \; send-keys -X select-word

# Enable triple-click to select line
bind -n TripleClick1Pane select-pane \; copy-mode -M \; send-keys -X select-line
bind -T copy-mode-vi TripleClick1Pane select-pane \; send-keys -X select-line

bind m set -g mouse \; display "Mouse: #{?mouse,ON,OFF}"

# Intuitive pane splitting with | and -
unbind '"'
unbind %
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Keybinding to rename current pane
bind P command-prompt -p "Pane Title:" "select-pane -T '%%'"

# Keybinding to copy entire pane content to clipboard
bind C run-shell "tmux capture-pane -pS - | pbcopy" \; display-message "Pane copied to clipboard"

# Pane borders - make them highly visible
set -g pane-border-style fg=colour240,bg=colour235
set -g pane-active-border-style fg=colour33,bg=colour235
set -g pane-border-lines heavy

# Display pane titles
set -g pane-border-status top
set -g pane-border-format "#{pane_index}: #{pane_title}"

# Selection/copy mode colors - green highlight
set -g mode-style "bg=colour78,fg=colour232"

# Set status bar
set -g status-bg black
set -g status-fg white
set -g status-left "#[fg=green]Session: #S #[fg=yellow]| #[fg=green]Window: #I #[fg=yellow]| #[fg=green]Pane: #P"
set -g status-right "#{?pane_in_mode,#[fg=yellow][#{pane_mode}]#[default] ,}%Y-%m-%d %H:%M"

# Enable vi keybindings
setw -g mode-keys vi

# Enable the use of arrows for pane navigation
set -g status-keys vi

# Unbind Alt+Arrow keys so they pass through to shell for word navigation
unbind -T root M-Up
unbind -T root M-Down
unbind -T root M-Left
unbind -T root M-Right

# Shortcut for source-file ~/.tmux/conf - Ctrl b r
bind r source-file ~/.tmux.conf

# Enable OSC 52 clipboard for copying over SSH
set -g set-clipboard on

# Bind key 'y' to copy to system clipboard (works locally and over SSH via OSC 52)
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'printf "\033]52;c;$(base64 | tr -d "\n")\a"'

# Bind key 'p' to paste the copied text - Ctrl b p
unbind p
bind p paste-buffer
